# KoBART ë…¼ë¬¸ ìš”ì•½ ëª¨ë¸ í•™ìŠµ í”„ë¡œì íŠ¸

ì´ í”„ë¡œì íŠ¸ëŠ” í•œêµ­ì–´ ë…¼ë¬¸ ì „ë¬¸ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ëŠ” KoBART ê¸°ë°˜ì˜ í…ìŠ¤íŠ¸ ìš”ì•½ ëª¨ë¸ì„ í•™ìŠµí•œ ì‘ì—…ì…ë‹ˆë‹¤. 

ì´ 3ê°œì˜ ì£¼ìš” ë…¸íŠ¸ë¶ì„ í†µí•´ ë°ì´í„° ì „ì²˜ë¦¬, ëª¨ë¸ í•™ìŠµ, PEFT(LORA) ì ìš© ì‹¤í—˜ì„ ë‹¨ê³„ì ìœ¼ë¡œ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.

---

## ğŸ“ ë…¸íŠ¸ë¶ êµ¬ì„±

| ë…¸íŠ¸ë¶ ì´ë¦„ | ì„¤ëª… |
|-------------|------|
| `dataset.ipynb` | ì›ë³¸ JSON ë°ì´í„°ë¥¼ í† í¬ë‚˜ì´ì¦ˆí•˜ê³  í•™ìŠµìš© ë°ì´í„°ì…‹ìœ¼ë¡œ ì €ì¥ |
| `kobart-peft-summary.ipynb` | LoRA ê¸°ë°˜ì˜ PEFT ê¸°ë²•ì„ ì ìš©í•˜ì—¬ íŒŒë¼ë¯¸í„° íš¨ìœ¨ì  ë¯¸ì„¸ì¡°ì • ìˆ˜í–‰ |

---

## ğŸ“š ë°ì´í„°ì…‹ ì „ì²˜ë¦¬ ë°©ì‹

- ì‚¬ìš© ë°ì´í„°: AI Hub í•œêµ­ì–´ ë…¼ë¬¸ ìš”ì•½ ë°ì´í„°
- ì›ë¬¸: `original_text`, ìš”ì•½: `summary_text`
- í† í¬ë‚˜ì´ì €: `PreTrainedTokenizerFast` from `gogamza/kobart-base-v2`
- `max_length=512`ë¡œ truncation ë° padding ì ìš©
- ìµœì¢… ë°ì´í„°ì…‹ì€ HuggingFace `Dataset` í¬ë§·ìœ¼ë¡œ ì €ì¥ í›„ í•™ìŠµì— ì‚¬ìš©

---

## ğŸ§  ëª¨ë¸ í•™ìŠµ ì„¤ì •

| í•­ëª© | ê°’ |
|------|----|
| Base model | `gogamza/kobart-base-v2` |
| í•™ìŠµ ì—í­ | 3 (PEFT ì‹¤í—˜) |
| ë°°ì¹˜ ì‚¬ì´ì¦ˆ | 32 |
| Learning Rate | 5e-5 |
| í•™ìŠµ ì¥ë¹„ | Kaggle P100 |

---

## ğŸ§ª PEFT (LoRA) ì‹¤í—˜

- `peft`, `transformers`, `accelerate` ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©
- LoraConfig ì„¤ì •:
  ```python
  LoraConfig(
      r=8,
      lora_alpha=32,
      lora_dropout=0.1,
      task_type=TaskType.SEQ_2_SEQ_LM
  )
  ```
- í•™ìŠµ íŒŒë¼ë¯¸í„° ìˆ˜: ì „ì²´ ëŒ€ë¹„ ì•½ 0.35%ë§Œ í•™ìŠµ

---

### ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ (100ê°œ ìƒ˜í”Œ ê¸°ì¤€)

| ë©”íŠ¸ë¦­            | ê°’     |
|-------------------|--------|
| **ROUGE-1**       | 0.1729 |
| **ROUGE-2**       | 0.0407 |
| **ROUGE-L**       | 0.1697 |
| **BERTScore (F1)** | 0.7853 |

---

### ğŸ§  í‰ê°€ í•´ì„

- ëª¨ë¸ì€ ì¼ë¶€ ë¬¸ì¥ì—ì„œ **ì›ë¬¸ ë¬¸ì¥ì„ ë°˜ë³µí•˜ê±°ë‚˜**, **í•µì‹¬ ì •ë³´ë¥¼ ì¶©ë¶„íˆ ìš”ì•½í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°**ê°€ ê´€ì°°ë¨

  ![image](https://github.com/user-attachments/assets/d92abe3a-9e9f-46d5-941c-231a567b7555)

- ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³ , **ì˜ë¯¸ì ìœ¼ë¡œëŠ” ì •ë‹µ ìš”ì•½ê³¼ ìœ ì‚¬í•œ ë‚´ìš©ì„ ìƒì„±í•œ ì‚¬ë¡€**ê°€ ë‹¤ìˆ˜ ì¡´ì¬í•¨

> ROUGE ì ìˆ˜ëŠ” ìƒëŒ€ì ìœ¼ë¡œ ë‚®ê²Œ ë‚˜íƒ€ë‚¬ìœ¼ë‚˜,  
> BERTScoreëŠ” ì˜ë¯¸ì  ìœ ì‚¬ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ í‰ê°€ ê²°ê³¼ë¥¼ ë°˜ì˜í•˜ë©° ë†’ì€ ì ìˆ˜ë¥¼ ê¸°ë¡í•¨

ì´ëŠ” ëª¨ë¸ì´ **ì •í™•íˆ ê°™ì€ ë‹¨ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šë”ë¼ë„**,  
**í•µì‹¬ ë‚´ìš©ì„ ì˜ë¯¸ì ìœ¼ë¡œ ì˜ ìš”ì•½í•˜ê³  ìˆìŒì„ ì‹œì‚¬í•¨**

| ì§€í‘œ         | í‰ê°€ ë°©ì‹ |
|--------------|------------|
| **ROUGE**    | ì •ë‹µ ìš”ì•½ê³¼ ìƒì„± ìš”ì•½ ê°„ì˜ **n-gram ë‹¨ìœ„ ë‹¨ì–´ ì¤‘ë³µë¥ **ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€ (í‘œí˜„ì´ ë‹¤ë¥´ë©´ ê°ì ) |
| **BERTScore** | ë¬¸ì¥ ê°„ **ì˜ë¯¸ì  ìœ ì‚¬ì„±**ì„ ì„ë² ë”© ê¸°ë°˜ìœ¼ë¡œ í‰ê°€ (ë‹¤ì–‘í•œ í‘œí˜„ë„ ì¸ì •) |

> ë…¼ë¬¸ ìš”ì•½ì²˜ëŸ¼ í‘œí˜„ì˜ ë‹¤ì–‘ì„±ì´ ì¤‘ìš”í•œ íƒœìŠ¤í¬ì—ì„œëŠ”  
> **BERTScoreê°€ ëª¨ë¸ ì„±ëŠ¥ì„ ë” ì •í™•í•˜ê²Œ ë°˜ì˜í•  ìˆ˜ ìˆìŒ**


---

## âœ… í–¥í›„ ê°œì„  ë°©í–¥

- ì¶”ë¡  ì‹œ `length_penalty` ë° `no_repeat_ngram_size` ì¡°ì •
- ì „ì´ í•™ìŠµì„ ìœ„í•œ ë‰´ìŠ¤ ìš”ì•½ â†’ ë…¼ë¬¸ ìš”ì•½ ë°©ì‹ ì‹œë„

---

## ğŸ–¼ï¸ ìš”ì•½ ê²°ê³¼

| ![image](https://github.com/user-attachments/assets/3f5001b6-b92c-44bc-8a69-16b724e9a2b2)

